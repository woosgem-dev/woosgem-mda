component:
  name: Modal
  category: organism
  description: Overlay dialog displayed on top of a backdrop. Composed of Header, Body, and Footer regions with focus trap and scroll lock behaviors.
  complexity: behavioral

semantics:
  tag: div
  role: dialog

attributes:
  open:
    type: boolean
    default: false
    description: Whether the modal is visible. When true, the modal and overlay are shown; when false, they are hidden.
  size:
    type: enum
    values: [sm, md, lg, xl, full]
    default: md
    description: Width preset of the modal dialog. "full" occupies the entire viewport.
  closable:
    type: boolean
    default: true
    description: Whether the close button is shown and ESC key / overlay click dismissal is allowed.

content:
  default:
    description: Container area for ModalHeader, ModalBody, and ModalFooter sub-components.
    required: true
    type: node
    cardinality: multiple

states:
  open:
    visual: Overlay backdrop and modal dialog are displayed.
    behavior: Body scroll is locked. Focus trap is activated so Tab cycles only within the modal. Focus moves to the first focusable element inside the modal.
    aria:
      modal: true
      hidden: false
  closed:
    visual: Modal and overlay are removed from view.
    behavior: Body scroll is restored. Focus trap is deactivated. Focus returns to the element that triggered the modal.
    aria:
      modal: true
      hidden: true

interactions:
  close:
    triggers: [Escape, overlay-click, close-button-click]
    condition:
      all:
        - { attr: open, eq: true }
        - { attr: closable, eq: true }
    effect: emit
    payload:
      source: string  # "escape" | "overlay" | "close-button"
    description: Closes the modal by requesting the parent to set open=false.

accessibility:
  aria:
    modal: "Always true when role=dialog"
    hidden: "true when open=false, false when open=true"
    labelledby: "Automatically linked to ModalHeader element id when header is present"
  keyboard:
    Escape: close
    Tab: "Focus trap — cycles forward through focusable elements within the modal"
    Shift+Tab: "Focus trap — cycles backward through focusable elements within the modal"
  focus: On open, focus moves to the first focusable element inside the modal. On close, focus returns to the trigger element.

visual_mapping:
  class: modal
  data_attributes:
    data-size:
      strategy: value-mapped
      source: size
    data-open:
      strategy: present-when-true
      source: open
    data-closable:
      strategy: present-when-true
      source: closable

composition:
  layout: [ModalHeader, ModalBody, ModalFooter]

  rendering:
    strategy: portal
    description: Rendered at the document top-level (body) to avoid z-index stacking context issues.

  dependencies:
    atoms: [Overlay]

  communication:
    pattern: context
    shared_state: [open, closable, onClose]

  sub_components:
    - name: ModalHeader
      tag: div
      description: Top region containing the title and an optional close button.
      required: false
      attributes:
        show-close:
          type: boolean
          default: true
          description: Whether to display the close button within the header.
      content:
        default:
          description: Title text or custom header content.
          required: true
          type: node
        close:
          description: Close button area. Renders a default X button if not overridden.
          required: false
          type: node
      visual_mapping:
        class: modal-header
        data_attributes:
          data-show-close:
            strategy: present-when-true
            source: show-close

    - name: ModalBody
      tag: div
      description: Main content region of the modal.
      required: true
      attributes:
        scrollable:
          type: boolean
          default: true
          description: Whether internal scrolling is enabled when body content overflows.
      content:
        default:
          description: Body content of the modal.
          required: true
          type: node
      visual_mapping:
        class: modal-body
        data_attributes:
          data-scrollable:
            strategy: present-when-true
            source: scrollable

    - name: ModalFooter
      tag: div
      description: Bottom region for action buttons such as confirm and cancel.
      required: false
      attributes:
        align:
          type: enum
          values: [start, center, end]
          default: end
          description: Horizontal alignment of footer content.
      content:
        default:
          description: Action buttons or other footer content.
          required: true
          type: node
      visual_mapping:
        class: modal-footer
        data_attributes:
          data-align:
            strategy: value-mapped
            source: align
